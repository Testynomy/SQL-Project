SELECT 
        s.skill_id,
        s.skills,
        count(sj.job_id) AS demand_count,
        round(AVG(jp.salary_year_avg), 0) AS avg_salary
FROM job_postings_fact AS jp
INNER JOIN skills_job_dim AS sj ON jp.job_id = sj.job_id
INNER JOIN skills_dim AS s ON sj.skill_id = s.skill_id
WHERE 
        job_title_short = 'Data Analyst'
        AND salary_year_avg IS NOT NULL
        AND job_work_from_home = TRUE
GROUP BY 
        s.skill_id
HAVING 
        count(sj.job_id) > 10
ORDER BY
        avg_salary DESC,
        demand_count DESC
LIMIT 25